@(streams : List[Stream], stream: Stream, myForm: Form[Stream])

@import helper._

@layout("Streams", session) {

    <!-- Docs nav
    ================================================== -->
	<div class="row">
		<div class="span2 bs-docs-sidebar">
		<br \><br \><br \>

				@if(streams.length > 0) {
				<h4>Streams</h4>
					<div id="vfileTree">
						<ul>
						@Html(FileSystem.listHTMLFileSystem(Secured.getCurrentUser()))
						</ul>
					</div>
				} else {
				}
  </div>

  <div class="span9">
		<br \>
		<!--Body content-->
		<!-- Stream listing and visualizing -->
		<h1>Stream '@stream.file.getPath()'</h1>
				<br />
				@helper.form(action = routes.CtrlStream.modify(stream.id)) {

					<legend>Parameters for the stream</legend>
					@vstream.includeStream(stream)
					<br />

					@textarea(
						myForm("description"),
						'rows -> 3,
						'_label -> "Description"
					)
					<br /> 

					<fieldset>

		      <legend>Location</legend>
					<div id="map-canvas" style="width: 600px; height: 300px"></div>
					<br />

					@if(stream.latitude==0 && stream.longtitude==0) {
						<dl class=" " id="latitude_field">
								<dt> <label for="latitude">Latitude</label></dt>
								<dd> <input type="text" id="latitude" name="latitude" value="" placeholder="" > </dd> 
						</dl>
						<dl class=" " id="longtitude_field">
								<dt> <label for="longtitude">Longtitude</label></dt>
								<dd> <input type="text" id="longtitude" name="longtitude" value="" placeholder=""> </dd> 
						</dl>
					} else {
						@inputText(
							myForm("latitude"),
							'_label -> "Latitude"
						)
						@inputText(
							myForm("longtitude"),
							'_label -> "Longtitude",
							'value  -> "L"
						)
					}
					</fieldset>
					<br /> <br />
					<div class="actions">
						<input type="submit" class="btn btn-primary" value="Update">
					</div>
					<br /> <br />
					<br /> <br />
				}
    </div>
  </div>

 <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA-9DrIlaZr8XjhHtcKgM8lluCrz0iqydk&sensor=true"> </script>
	<script type="text/javascript">
      function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(@stream.latitude, @stream.longtitude),
					@if(stream.latitude==0 && stream.longtitude==0) {
						zoom: 1,
					} else {
						zoom: 7,
					}
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map-canvas"),
            mapOptions);
				marker = new google.maps.Marker({
					position: new google.maps.LatLng(@stream.latitude, @stream.longtitude),
					draggable:true,
					animation:false,
					map: map
      });
			google.maps.event.addListener(marker, 'dragend', function(event) {
        document.getElementById("latitude").value = this.getPosition().lat(); 
        document.getElementById("longtitude").value = this.getPosition().lng();
			});
}
      google.maps.event.addDomListener(window, 'load', initialize);
	</script>
}
