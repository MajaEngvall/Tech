@(resource: Resource, owned: Boolean)

@import helper._

@displayResource(endPoint: EndPoint) = {
 
  @if(owned) {    
	  @if(endPoint.url!="") {
	    @form(routes.CtrlResource.setPeriod(resource.id,0)) {
	      <dl>
	      <dt class="action">Enter polling interval</dt>
	      <dd>  
  	      <input input type="hidden" name="id" value="@resource.id" />
	        <input input type="number" name="period" required placeholder="Period" class="input" size="4" style="text-align:right;"/>
	        <input type="submit" value="Ok" class="buttonG"/>
	      </dd>
	      </dl>
      }
    }
	}
	    
	 @if(endPoint.url!="") {
      <dl>
      <dt class="action">Send REST request</dt>
      <dd>
        <form id="proxy@resource.id" action="@routes.Proxy.forwardById(resource.id, "")">
	       <select id="method@resource.id" name="method" >
           <option value="GET">GET</option>
           <option value="POST">POST</option>
           <option value="PUT">PUT</option>
           <option value="DELETE">DELETE</option>
         </select>
         <input input type="text" id="arguments@resource.id" name="arguments" placeholder="arguments" size="8"/>
         <input input type="text" id="body@resource.id" name="body" placeholder="body" size="8"/>
         <input type="submit" value="Send" class="buttonG"/>
        </form>
        <img id="ajax_wait@resource.id" src="@routes.Assets.at("images/ajax_wait.gif")" height="20" align="top" style="visibility:hidden;"></img>
      </dd>
      
      <div id="response@resource.id" style="display: none">
	      <dt class="action">
	        <span id="response1@resource.id"></span>
	      </dt>
	      <dd>
	        <code><span id="response2@resource.id"></span></code>
	      </dd>
      </div>
       </dl>
     
     <script type="text/javascript">
	  $('#proxy@resource.id').submit(function() {
	    var method = $("select#method@resource.id").val();
	    var arguments = $("input#arguments@resource.id").val();
	    var body = $("input#body@resource.id").val();
	    $("#ajax_wait@resource.id").css("visibility","visible");
	    $.ajax({
	    	  url: "@routes.Proxy.forwardById(resource.id, "")" + "?arguments=" + arguments,
	    	  context: document.body,
	    	  timeout: 5000,
	    	  type: method,
	    	  data: body,
	    	  contentType: "text/plain",
    	    error: function(x, t, m) {
    	    	$("#response1@resource.id").html("Error");
    	    	$("#response2@resource.id").text(m);
            $("#response@resource.id").show(200);
    	    	$("#ajax_wait@resource.id").css("visibility","hidden");
    	    },
    	    success: function(response) {
    	    	$("#response1@resource.id").html("Response");
            $("#response2@resource.id").text(response);
            $("#response@resource.id").show();
            $("#ajax_wait@resource.id").css("visibility","hidden");
           }
	    	});
	    			    
	    return false;
	  });
	  </script>
	}
}

@displayResource(resource.getEndPoint())
